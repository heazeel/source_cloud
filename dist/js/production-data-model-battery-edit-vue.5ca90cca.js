(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["production-data-model-battery-edit-vue"],{b43b:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("drawer-right",{staticClass:"model-battery-edit",attrs:{title:"电池型号"+e.action.title,width:"800px","submit-func":e.handleSubmit},on:{open:e.init,cancel:function(t){return e.$router.back()}}},[r("el-form",{ref:"form",staticClass:"form-drawer",attrs:{rules:e.rules,model:e.form,"label-width":"180px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[r("el-form-item",{attrs:{label:"型号名称",prop:"code"}},[r("el-input",{attrs:{placeholder:"请输入3-32位字符"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),r("el-form-item",{attrs:{label:"电池重量",prop:"weight"}},[r("el-input",{attrs:{placeholder:"请输入数字，保留2位小数"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("kg")])])],1),r("el-form-item",{attrs:{label:"额定容量",prop:"rated_cap"}},[r("el-input",{attrs:{placeholder:"请输入整数"},model:{value:e.form.rated_cap,callback:function(t){e.$set(e.form,"rated_cap",t)},expression:"form.rated_cap"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("Wh")])])],1),r("el-form-item",{attrs:{label:"标称容量",prop:"nominal_cap"}},[r("el-input",{attrs:{placeholder:"请输入整数"},model:{value:e.form.nominal_cap,callback:function(t){e.$set(e.form,"nominal_cap",t)},expression:"form.nominal_cap"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("Ah")])])],1),r("el-form-item",{attrs:{label:"最大可循环次数",prop:"max_cycle_count"}},[r("el-input",{attrs:{placeholder:"请输入整数"},model:{value:e.form.max_cycle_count,callback:function(t){e.$set(e.form,"max_cycle_count",t)},expression:"form.max_cycle_count"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("次")])])],1),r("el-form-item",{attrs:{label:"定检时间周期",prop:"time_check_period"}},[r("el-input",{attrs:{placeholder:"请输入整数"},model:{value:e.form.time_check_period,callback:function(t){e.$set(e.form,"time_check_period",t)},expression:"form.time_check_period"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("天")])])],1),r("el-form-item",{attrs:{label:"标称截止电压",prop:"cut_off_volt"}},[r("el-input",{attrs:{placeholder:"请输入数字，保留2位小数"},model:{value:e.form.cut_off_volt,callback:function(t){e.$set(e.form,"cut_off_volt",t)},expression:"form.cut_off_volt"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("V")])])],1),r("el-form-item",{attrs:{label:"定检使用周期",prop:"use_check_period"}},[r("el-input",{attrs:{placeholder:"请输入整数"},model:{value:e.form.use_check_period,callback:function(t){e.$set(e.form,"use_check_period",t)},expression:"form.use_check_period"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("h")])])],1),r("el-form-item",{attrs:{label:"测量电压",prop:"min_measured_volt"}},[r("el-row",[r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{"label-width":"0",prop:"min_measured_volt"}},[r("el-input",{attrs:{placeholder:"最小"},model:{value:e.form.min_measured_volt,callback:function(t){e.$set(e.form,"min_measured_volt",t)},expression:"form.min_measured_volt"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("V")])])],1)],1),r("el-col",{staticStyle:{"text-align":"center"},attrs:{span:4}},[e._v(" - ")]),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{"label-width":"0",prop:"max_measured_volt"}},[r("el-input",{attrs:{placeholder:"最大"},model:{value:e.form.max_measured_volt,callback:function(t){e.$set(e.form,"max_measured_volt",t)},expression:"form.max_measured_volt"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("V")])])],1)],1)],1)],1),r("el-form-item",{attrs:{label:"标称满电电压",prop:"full_power_volt"}},[r("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.form.full_power_volt,callback:function(t){e.$set(e.form,"full_power_volt",t)},expression:"form.full_power_volt"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("V")])])],1),r("el-form-item",{attrs:{label:"容量衰减系数",prop:"power_decay_factor"}},[r("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.form.power_decay_factor,callback:function(t){e.$set(e.form,"power_decay_factor",t)},expression:"form.power_decay_factor"}})],1),r("el-form-item",{attrs:{label:"单电池循环平均时长",prop:"cycle_average_duration"}},[r("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.form.cycle_average_duration,callback:function(t){e.$set(e.form,"cycle_average_duration",t)},expression:"form.cycle_average_duration"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("h")])])],1),r("el-form-item",{attrs:{label:"健康状态标准参数",prop:"standard_parameters"}},[r("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.form.standard_parameters,callback:function(t){e.$set(e.form,"standard_parameters",t)},expression:"form.standard_parameters"}})],1),r("el-form-item",{attrs:{label:"最低可用软件版本",prop:"lowest_software_version"}},[r("el-input",{attrs:{placeholder:"请输入版本号"},model:{value:e.form.lowest_software_version,callback:function(t){e.$set(e.form,"lowest_software_version",t)},expression:"form.lowest_software_version"}})],1),r("el-form-item",{attrs:{label:"健康状态临界参数",prop:"critical_parameters"}},[r("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.form.critical_parameters,callback:function(t){e.$set(e.form,"critical_parameters",t)},expression:"form.critical_parameters"}})],1),r("el-form-item",{attrs:{label:"出厂价格",prop:"price"}},[r("el-input",{attrs:{placeholder:"请输入大于0的数字"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("元")])])],1),r("el-form-item",{staticClass:"block",attrs:{label:"电压带载转空载换算系数",prop:"conversion_factor"}},[r("el-input",{attrs:{placeholder:"顺序输入2个数字，用“,”隔开"},model:{value:e.form.conversion_factor,callback:function(t){e.$set(e.form,"conversion_factor",t)},expression:"form.conversion_factor"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"电容-电压曲线",prop:"volt_cap_relation"}},[r("el-input",{attrs:{placeholder:"顺序输入11个数字，用“,”隔开"},model:{value:e.form.volt_cap_relation,callback:function(t){e.$set(e.form,"volt_cap_relation",t)},expression:"form.volt_cap_relation"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"电容-温度曲线",prop:"temp_cap_relation"}},[r("el-input",{attrs:{placeholder:"顺序输入3个数字，用“,”隔开"},model:{value:e.form.temp_cap_relation,callback:function(t){e.$set(e.form,"temp_cap_relation",t)},expression:"form.temp_cap_relation"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"备注",prop:"comment"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1)],1)},a=[],l=(r("a9e3"),r("96cf"),r("1da1")),s=r("5530"),i=r("6dc5"),n={create:{title:"新建",type:"create",submitFunc:i["modelCreate"]},update:{title:"修改",type:"update",submitFunc:i["modelUpdate"]}},c={code:null,weight:null,rated_cap:340,nominal_cap:340,max_cycle_count:400,time_check_period:30,cut_off_volt:null,use_check_period:100,full_power_volt:300,min_measured_volt:null,max_measured_volt:null,power_decay_factor:null,cycle_average_duration:null,standard_parameters:null,lowest_software_version:null,critical_parameters:null,price:null,conversion_factor:null,volt_cap_relation:null,temp_cap_relation:null,comment:null},m={name:"ModelBatteryEdit",data:function(){var e=this,t=function(t,r,o){return e.form.max_measured_volt<r?o(new Error("最小值不可大于最大值")):o()},r=function(t,r,o){return r<e.form.min_measured_volt?o(new Error("最大值不可小于最小值")):(e.$refs.form.validateField("min_measured_volt"),o())};return{action:n.create,form:this.$lodash.cloneDeep(c),rules:{code:[{required:!0,message:"请输入型号名称"},this.$tools.formRules.default,this.$tools.formRules.repeatCheck({id:this.$route.query.id,module:"batterymodel",field:"code"})],weight:[{required:!0,message:"请输入电池重量"},this.$tools.formRules.numberFixed(2)],rated_cap:[{required:!0,message:"请输入额定容量"},this.$tools.formRules.numberInt],nominal_cap:[{required:!0,message:"请输入标称容量"},this.$tools.formRules.numberInt],max_cycle_count:[{required:!0,message:"请输入最大可循环次数"},this.$tools.formRules.numberInt],time_check_period:[{required:!0,message:"请输入定检时间周期"},this.$tools.formRules.numberInt],cut_off_volt:[{required:!0,message:"请输入标称截止电压"},this.$tools.formRules.numberFixed(2)],use_check_period:[{required:!0,message:"请输入定检使用周期"},this.$tools.formRules.numberInt],full_power_volt:[{required:!0,message:"请输入标称满电电压"},this.$tools.formRules.number],power_decay_factor:[{required:!0,message:"请输入容量衰减系数"},this.$tools.formRules.number],cycle_average_duration:[{required:!0,message:"请输入单电池循环平均时长"},this.$tools.formRules.number],standard_parameters:[{required:!0,message:"请输入健康状态标准参数"},this.$tools.formRules.number],lowest_software_version:[{required:!0,message:"请输入最低可用软件版本"}],critical_parameters:[{required:!0,message:"请输入健康状态临界参数"},this.$tools.formRules.number],price:[{required:!0,message:"请输入出厂价格"},this.$tools.formRules.number],conversion_factor:[{required:!0,message:"请输入电压带载转空载换算系数"},this.$tools.formRules.multipleParams(2)],volt_cap_relation:[{required:!0,message:"请输入电容-电压曲线"},this.$tools.formRules.multipleParams(11)],temp_cap_relation:[{required:!0,message:"请输入电容-温度曲线"},this.$tools.formRules.multipleParams(3)],min_measured_volt:[{required:!0,message:"请输入最小值"},this.$tools.formRules.number,{validator:t}],max_measured_volt:[{required:!0,message:"请输入最大值"},this.$tools.formRules.number,{validator:r}]}}},watch:{"$route.query.id":{handler:function(e){this.action=e||0===e?Object(s["a"])({},n.update,{id:e}):n.create},immediate:!0}},methods:{init:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("create"!==e.action.type){t.next=4;break}e.form=e.$lodash.cloneDeep(c),t.next=12;break;case 4:if("update"!==e.action.type){t.next=12;break}return t.next=7,Object(i["modelDetailSearch"])({id:e.action.id},{loading:!0});case 7:if(r=t.sent,200===r.code){t.next=11;break}return e.form=e.$lodash.cloneDeep(c),t.abrupt("return");case 11:e.form=r.content;case 12:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:return o={code:e.form.code,weight:Number(e.form.weight),rated_cap:Number(e.form.rated_cap),nominal_cap:Number(e.form.nominal_cap),max_cycle_count:Number(e.form.max_cycle_count),time_check_period:Number(e.form.time_check_period),cut_off_volt:Number(e.form.cut_off_volt),use_check_period:Number(e.form.use_check_period),full_power_volt:Number(e.form.full_power_volt),min_measured_volt:Number(e.form.min_measured_volt),max_measured_volt:Number(e.form.max_measured_volt),power_decay_factor:Number(e.form.power_decay_factor),cycle_average_duration:Number(e.form.cycle_average_duration),standard_parameters:Number(e.form.standard_parameters),lowest_software_version:Number(e.form.lowest_software_version),critical_parameters:Number(e.form.critical_parameters),price:Number(e.form.price),conversion_factor:e.form.conversion_factor,volt_cap_relation:e.form.volt_cap_relation,temp_cap_relation:e.form.temp_cap_relation,comment:e.form.comment},"update"===e.action.type&&(o.id=e.action.id),t.next=10,e.action.submitFunc(o,{loading:!0});case 10:if(a=t.sent,200===a.code){t.next=13;break}return t.abrupt("return");case 13:e.$message({message:"".concat(e.action.title,"成功！"),type:"success",containerType:"drawer",onClose:function(){e.$router.back()}}),t.next=19;break;case 16:return t.prev=16,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()}}},u=m,f=r("2877"),p=Object(f["a"])(u,o,a,!1,null,null,null);t["default"]=p.exports}}]);