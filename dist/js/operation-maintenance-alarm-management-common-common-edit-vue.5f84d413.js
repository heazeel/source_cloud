(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["operation-maintenance-alarm-management-common-common-edit-vue"],{c796:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("drawer-right",{staticClass:"alarm-management-edit",attrs:{title:"告警"+e.action.title,width:"700px","submit-func":e.handleSubmit},on:{open:e.init,cancel:function(t){return e.$router.back()}}},[r("el-form",{ref:"form",staticClass:"form-drawer",attrs:{rules:e.rules,model:e.form,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[r("el-form-item",{staticClass:"block",attrs:{label:"编号",prop:"no",rules:[{required:!0,message:"请输入编号"},e.$tools.formRules.pureNumber,e.$tools.formRules.repeatCheck({value:e.form.no,id:e.form.id,module:"alarm",field:"no"})]}},[r("el-input",{attrs:{placeholder:"请输入编号"},model:{value:e.form.no,callback:function(t){e.$set(e.form,"no",t)},expression:"form.no"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"告警名称",prop:"name",rules:[{required:!0,message:"请输入告警名称"},e.$tools.formRules.stringRange({min:0,max:32}),e.$tools.formRules.repeatCheck({value:e.form.name,id:e.form.id,module:"alarm",field:"name"})]}},[r("el-input",{attrs:{placeholder:"请输入告警名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"告警名称(英)",prop:"name_en",rules:[{required:!0,message:"请输入告警名称英文"},e.$tools.formRules.stringRange({min:0,max:128}),e.$tools.formRules.repeatCheck({value:e.form.name_en,id:e.form.id,module:"alarm",field:"name_en"})]}},[r("el-input",{attrs:{placeholder:"请输入告警名称英文名"},model:{value:e.form.name_en,callback:function(t){e.$set(e.form,"name_en",t)},expression:"form.name_en"}})],1),r("el-form-item",{attrs:{label:"状态",prop:"disabled"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},e._l(e.ALARM_DISABLED,(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1)],1),r("el-form-item",{attrs:{label:"是否允许忽略",prop:"ignored"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.ignored,callback:function(t){e.$set(e.form,"ignored",t)},expression:"form.ignored"}},e._l(e.ALARM_IGNORED,(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1)],1),r("el-form-item",{attrs:{label:"告警类型",prop:"alarm_type"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.alarm_type,callback:function(t){e.$set(e.form,"alarm_type",t)},expression:"form.alarm_type"}},e._l(e.ALARM_TYPE,(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1)],1),r("el-form-item",{attrs:{label:"响应等级",prop:"level"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},e._l(e.ALARM_LEVEL,(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1)],1),r("el-form-item",{staticClass:"block",attrs:{label:"建议措施",prop:"tips"}},[r("el-input",{attrs:{placeholder:"请输入建议措施",type:"textarea"},model:{value:e.form.tips,callback:function(t){e.$set(e.form,"tips",t)},expression:"form.tips"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"备注",prop:"comment"}},[r("el-input",{attrs:{placeholder:"请输入备注",type:"textarea"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1)],1)},n=[],l=(r("b0c0"),r("96cf"),r("1da1")),o=r("5530"),i=r("ef37"),s=r("4c6b"),m={create:{title:"新建",type:"create",submitFunc:i["a"]},update:{title:"修改",type:"update",submitFunc:i["e"]}},c={no:null,name:null,name_en:null,device_type:null,level:null,alarm_type:null,tips:null,ignored:null,disabled:null,comment:null},u={name:"AlarmManagementEdit",props:{deviceType:{type:String,default:function(){return""}}},data:function(){return{action:m.create,form:this.$lodash.cloneDeep(c),rules:{disabled:[{required:!0,message:"请选择状态"}],ignored:[{required:!0,message:"是否允许忽略"}],alarm_type:[{required:!0,message:"请选择告警类型"}],level:[{required:!0,message:"请选择响应等级"}],tips:[this.$tools.formRules.stringRange({min:0,max:128})],comment:[this.$tools.formRules.stringRange({min:0,max:128})]},ALARM_DISABLED:s["a"],ALARM_IGNORED:s["b"],ALARM_LEVEL:s["c"],ALARM_TYPE:s["d"]}},watch:{"$route.query.id":{handler:function(e){this.action=e||0===e?Object(o["a"])({},m.update,{id:e}):m.create},immediate:!0}},methods:{init:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("create"!==e.action.type){t.next=5;break}e.form=e.$lodash.cloneDeep(c),t.next=13;break;case 5:if("update"!==e.action.type){t.next=13;break}return t.next=8,Object(i["b"])({id:e.action.id},{loading:!0});case 8:if(r=t.sent,200===r.code){t.next=12;break}return e.form=e.$lodash.cloneDeep(c),t.abrupt("return");case 12:e.form=r.content;case 13:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:return a={no:e.form.no,name:e.form.name,name_en:e.form.name_en,device_type:e.$tools.deviceTypeNameConversion(e.deviceType),alarm_type:e.form.alarm_type,level:e.form.level,tips:e.form.tips,ignored:e.form.ignored,disabled:e.form.disabled,comment:e.form.comment},"update"===e.action.type&&(a.id=e.form.id),t.next=10,e.action.submitFunc(a,{loading:!0});case 10:if(n=t.sent,200===n.code){t.next=13;break}return t.abrupt("return");case 13:e.$message({message:"".concat(e.action.title,"成功！"),type:"success",containerType:"drawer",onClose:function(){e.$router.back()}}),t.next=19;break;case 16:return t.prev=16,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()}}},f=u,d=r("2877"),p=Object(d["a"])(f,a,n,!1,null,null,null);t["default"]=p.exports},ef37:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return i})),r.d(t,"d",(function(){return s}));var a=r("0d5e"),n=function(e,t){return Object(a["get"])("/dev/alarm/search",e,t)},l=function(e,t){return Object(a["get"])("/dev/alarm/detail/search",e,t)},o=function(e,t){return Object(a["post"])("/dev/alarm/create",e,t)},i=function(e,t){return Object(a["post"])("/dev/alarm/update",e,t)},s=function(e,t){return Object(a["post"])("/dev/alarm/update",e,t)}}}]);