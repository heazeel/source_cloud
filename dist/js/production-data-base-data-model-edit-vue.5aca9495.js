(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["production-data-base-data-model-edit-vue"],{"0cde":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("drawer-right",{staticClass:"model-edit",attrs:{title:"型号"+e.action.title,width:"700px","submit-func":e.handleSubmit},on:{open:e.init,cancel:function(t){return e.$router.back()}}},[r("el-form",{ref:"form",staticClass:"form-drawer",attrs:{rules:e.rules,model:e.form,"label-width":"110px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[r("el-form-item",{attrs:{label:"类别",prop:"type"}},[r("select-remote",{attrs:{"api-key-obj":{type:"baseModel",funcName:"remoteTypeSelect"}},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),r("el-form-item",{attrs:{label:"原厂",prop:"factory"}},[r("select-remote",{attrs:{"other-key":"code","api-key-obj":{type:"baseModel",funcName:"remoteFactorySelect"}},on:{change:e.initFactoryCode},model:{value:e.form.factory,callback:function(t){e.$set(e.form,"factory",t)},expression:"form.factory"}})],1),r("el-form-item",{attrs:{label:"型号",prop:"code",rules:[{required:!0,message:"请输入零部件型号"},e.$tools.formRules.code,e.$tools.formRules.repeatCheck({value:e.form.code,id:e.form.id,module:"partmodel",field:"code"})]}},[r("el-input",{attrs:{disabled:"create"!=e.action.type,placeholder:"请输入型号编码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),r("el-form-item",{attrs:{label:"原厂编码",prop:"factory_code"}},[e._v(" "+e._s(e.form.factory_code)+" ")]),r("el-form-item",{attrs:{label:"维护时间周期",prop:"time_check_period"}},[r("el-input",{attrs:{disabled:"create"!=e.action.type,placeholder:"请输入数字"},model:{value:e.form.time_check_period,callback:function(t){e.$set(e.form,"time_check_period",t)},expression:"form.time_check_period"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("天")])])],1),r("el-form-item",{attrs:{label:"维护使用周期",prop:"use_check_period"}},[r("el-input",{attrs:{disabled:"create"!=e.action.type,placeholder:"请输入数字"},model:{value:e.form.use_check_period,callback:function(t){e.$set(e.form,"use_check_period",t)},expression:"form.use_check_period"}},[r("span",{staticClass:"unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("h")])])],1)],1)],1)},a=[],c=(r("96cf"),r("1da1")),i=r("5530"),n=r("ed55"),s={create:{title:"新建",type:"create",submitFunc:n["create"]}},l={code:null,type:null,factory:null,factory_id:null,factory_code:null,time_check_period:null,use_check_period:null},u={name:"ModelEdit",data:function(){return{action:s.create,form:this.$lodash.cloneDeep(l),rules:{type:[{required:!0,message:"请选择类别"}],factory:[{required:!0,message:"请选择原厂"},this.$tools.formRules.code],time_check_period:[{required:!0,message:"请输入维护时间周期"},this.$tools.formRules.pureNumber],use_check_period:[{required:!0,message:"请输入维护使用周期"},this.$tools.formRules.pureNumber]}}},watch:{"$route.query.id":{handler:function(e){this.action=e||0===e?Object(i["a"])({},s.update,{id:e}):s.create},immediate:!0}},methods:{init:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"create"===e.action.type&&(e.form=e.$lodash.cloneDeep(l));case 1:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:return o={code:e.form.code,type_id:e.form.type,factory_id:e.form.factory_id,time_check_period:e.form.time_check_period,use_check_period:e.form.use_check_period},"update"===e.action.type&&(o.id=e.form.id),t.next=10,e.action.submitFunc(o,{loading:!0});case 10:if(a=t.sent,200===a.code){t.next=13;break}return t.abrupt("return");case 13:e.$message({message:"".concat(e.action.title,"成功！"),type:"success",containerType:"drawer",onClose:function(){e.$router.back()}}),t.next=19;break;case 16:return t.prev=16,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},initFactoryCode:function(e){this.form.factory_code=e.item.code,this.form.factory_id=e.item.id}}},d=u,m=r("2877"),f=Object(m["a"])(d,o,a,!1,null,null,null);t["default"]=f.exports}}]);