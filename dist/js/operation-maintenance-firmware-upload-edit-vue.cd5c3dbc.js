(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["operation-maintenance-firmware-upload-edit-vue"],{"0585":function(e,t,r){"use strict";var n=r("53cae"),a=r.n(n);a.a},"53cae":function(e,t,r){},7881:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("drawer-right",{staticClass:"firmware-upload-edit",attrs:{size:"mini",title:"固件上传"+e.action.title,"submit-func":e.handleSubmit},on:{open:e.init,cancel:function(t){return e.$router.back()}}},[n("el-form",{ref:"form",staticClass:"form-drawer",attrs:{model:e.form,"label-width":"90px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[n("el-form-item",{staticClass:"block",attrs:{label:"设备类型",prop:"device_type",rules:[{required:!0,message:"请选择设备类型"}]}},[n("el-select",{attrs:{placeholder:"请选择设备类型"},model:{value:e.form.device_type,callback:function(t){e.$set(e.form,"device_type",t)},expression:"form.device_type"}},e._l(e.DEV_TYPE,(function(e){return n("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1)],1),n("el-form-item",{staticClass:"block",attrs:{label:"版本",prop:"version",rules:[{required:!0,message:"请选择版本"}]}},[n("el-select",{attrs:{placeholder:"请选择版本"},model:{value:e.form.version,callback:function(t){e.$set(e.form,"version",t)},expression:"form.version"}},e._l(e.VERSION,(function(e){return n("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1)],1),n("el-form-item",{staticClass:"block",attrs:{label:"版本号",prop:"version_no",rules:[{required:!0,message:"请输入版本号"}]}},[n("el-input",{attrs:{placeholder:"请输入版本号"},model:{value:e.form.version_no,callback:function(t){e.$set(e.form,"version_no",t)},expression:"form.version_no"}})],1),n("el-form-item",{staticClass:"block",attrs:{label:"固件",prop:"file",rules:[{required:!0,message:"请选择需要上传的文件"}]},model:{value:e.form.file_name,callback:function(t){e.$set(e.form,"file_name",t)},expression:"form.file_name"}},[n("el-upload",{ref:"uploadFile",staticClass:"firmware-upload",attrs:{name:"file",action:"#",drag:"",multiple:!1,"auto-upload":!1,"show-file-list":!1,"on-change":e.uploadFile}},[null===e.form.file_name?n("i",{staticClass:"el-icon-upload"}):e._e(),null===e.form.file_name?n("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或点击上传 ")]):e._e(),null!==e.form.file_name?n("div",{staticClass:"file-box"},[n("img",{staticClass:"file-img",attrs:{src:r("945f")}}),n("p",[e._v(e._s(e.form.file_name))])]):e._e()])],1)],1)],1)},a=[],i=(r("b0c0"),r("96cf"),r("1da1")),o=r("5530"),l=r("a6f2"),s=r("4c6b"),c={create:{title:"新建",type:"create",submitFunc:l["a"]}},u={device_type:null,version:null,version_no:null,file:null,file_name:null},f={name:"FirmwareUploadEdit",data:function(){return{action:c.create,form:this.$lodash.cloneDeep(u),DEV_TYPE:s["h"],VERSION:s["o"]}},watch:{"$route.query.id":{handler:function(e){this.action=e||0===e?Object(o["a"])({},c.update,{id:e}):c.create},immediate:!0}},methods:{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"create"===e.action.type&&(e.form=e.$lodash.cloneDeep(u));case 1:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:return n=new FormData,n.append("device_type",e.form.device_type),n.append("version",e.form.version),n.append("version_no",e.form.version_no),n.append("file",e.form.file),"update"===e.action.type&&(n.id=e.action.id),t.next=14,e.action.submitFunc(n,{loading:!0,formData:!0});case 14:if(a=t.sent,200===a.code){t.next=17;break}return t.abrupt("return");case 17:e.$message({message:"".concat(e.action.title,"成功！"),type:"success",containerType:"drawer",onClose:function(){e.$router.back()}}),t.next=23;break;case 20:return t.prev=20,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))()},uploadFile:function(e,t){this.form.file=e.raw,this.form.file_name=e.name}}},m=f,p=(r("0585"),r("2877")),d=Object(p["a"])(m,n,a,!1,null,null,null);t["default"]=d.exports},a6f2:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("0d5e"),a=function(e,t){return Object(n["post"])("/dev/firmware/file/create",e,t)},i=function(e,t){return Object(n["get"])("/dev/firmware/file/search",e,t)},o=function(e,t){return Object(n["post"])("/dev/firmware/file/delete",e,t)}}}]);