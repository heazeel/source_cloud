(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["operation-maintenance-firmware-release-common-common-edit-vue"],{6062:function(e,t,r){"use strict";var o=r("6d61"),a=r("6566");e.exports=o("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a)},6148:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("drawer-right",{staticClass:"firmware-release-edit",attrs:{title:"固件版本"+e.action.title,width:"700px","submit-func":e.handleSubmit},on:{open:e.init,cancel:function(t){return e.$router.back()}}},[r("el-form",{ref:"form",staticClass:"form-drawer",attrs:{model:e.form,rules:e.rules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[r("el-form-item",{staticClass:"block",attrs:{label:"版本号",prop:"version_no",rules:[{required:!0,message:"请输入版本号"},e.$tools.formRules.default,e.$tools.formRules.code,e.$tools.formRules.repeatCheck({value:e.form.version_no,module:"firmware",field:"version_no"})]}},[r("el-input",{attrs:{placeholder:"请输入数字、字母组合"},model:{value:e.form.version_no,callback:function(t){e.$set(e.form,"version_no",t)},expression:"form.version_no"}})],1),r("el-form-item",{staticClass:"block",attrs:{label:"系统信息",prop:"sys_ip_port"}},[r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch1,placeholder:"branch"},model:{value:e.form.sys_branch,callback:function(t){e.$set(e.form,"sys_branch",t)},expression:"form.sys_branch"}}),r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch2,placeholder:"version"},model:{value:e.form.sys_version,callback:function(t){e.$set(e.form,"sys_version",t)},expression:"form.sys_version"}}),"drone"===e.deviceType||"ustation"===e.deviceType?r("el-select",{staticStyle:{width:"33.3%"},attrs:{placeholder:"ip_port"},model:{value:e.form.sys_ip_port,callback:function(t){e.$set(e.form,"sys_ip_port",t)},expression:"form.sys_ip_port"}},e._l(e.ip_port["sys"],(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1):e._e(),"rcd"===e.deviceType?r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch7,placeholder:"ip_port"},model:{value:e.form.sys_ip_port,callback:function(t){e.$set(e.form,"sys_ip_port",t)},expression:"form.sys_ip_port"}}):e._e()],1),r("el-form-item",{staticClass:"block",attrs:{label:"依赖库信息",prop:"lib_ip_port"}},[r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch3,placeholder:"branch"},model:{value:e.form.lib_branch,callback:function(t){e.$set(e.form,"lib_branch",t)},expression:"form.lib_branch"}}),r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch4,placeholder:"version"},model:{value:e.form.lib_version,callback:function(t){e.$set(e.form,"lib_version",t)},expression:"form.lib_version"}}),"drone"===e.deviceType||"ustation"===e.deviceType?r("el-select",{staticStyle:{width:"33.3%"},attrs:{placeholder:"ip_port"},model:{value:e.form.lib_ip_port,callback:function(t){e.$set(e.form,"lib_ip_port",t)},expression:"form.lib_ip_port"}},e._l(e.ip_port["lib"],(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1):e._e(),"rcd"===e.deviceType?r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch8,placeholder:"ip_port"},model:{value:e.form.lib_ip_port,callback:function(t){e.$set(e.form,"lib_ip_port",t)},expression:"form.lib_ip_port"}}):e._e()],1),r("el-form-item",{staticClass:"block",attrs:{label:"应用程序信息",prop:"app_ip_port"}},[r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch5,placeholder:"branch"},model:{value:e.form.app_branch,callback:function(t){e.$set(e.form,"app_branch",t)},expression:"form.app_branch"}}),r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch6,placeholder:"version"},model:{value:e.form.app_version,callback:function(t){e.$set(e.form,"app_version",t)},expression:"form.app_version"}}),"drone"===e.deviceType||"ustation"===e.deviceType?r("el-select",{staticStyle:{width:"33.3%"},attrs:{placeholder:"ip_port"},model:{value:e.form.app_ip_port,callback:function(t){e.$set(e.form,"app_ip_port",t)},expression:"form.app_ip_port"}},e._l(e.ip_port["app"],(function(e){return r("el-option",{key:e.key,attrs:{label:e.text,value:e.key}})})),1):e._e(),"rcd"===e.deviceType?r("el-autocomplete",{staticStyle:{width:"33.3%"},attrs:{"fetch-suggestions":e.querySearch9,placeholder:"ip_port"},model:{value:e.form.app_ip_port,callback:function(t){e.$set(e.form,"app_ip_port",t)},expression:"form.app_ip_port"}}):e._e()],1),r("el-form-item",{staticClass:"block",attrs:{label:"备注",prop:"comment"}},[r("el-input",{attrs:{placeholder:"请输入备注",type:"textarea"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1)],1)},a=[],i=(r("99af"),r("4de4"),r("c975"),r("d81d"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("6b75"));function n(e){if(Array.isArray(e))return Object(i["a"])(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("e260");function s(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var c=r("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e){return n(e)||s(e)||Object(c["a"])(e)||l()}r("96cf");var u=r("1da1"),m=r("5530"),f=r("a237"),_=r("4c6b"),h={create:{title:"新建",type:"create",submitFunc:f["create"]}},d={version_no:null,device_type:null,sys_branch:null,sys_version:null,sys_ip_port:null,lib_branch:null,lib_version:null,lib_ip_port:null,app_branch:null,app_version:null,app_ip_port:null,comment:null},b={name:"FirmwareReleaseEdit",props:{deviceType:{type:String,default:function(){return""}}},data:function(){return{action:h.create,form:this.$lodash.cloneDeep(d),rules:{version:[{required:!0,message:"请输入版本号"}],sys_ip_port:[{required:!0,message:"系统信息不能为空"}],lib_ip_port:[{required:!0,message:"依赖库信息不能为空"}],app_ip_port:[{required:!0,message:"应用程序信息不能为空"}],comment:[this.$tools.formRules.stringRange({min:0,max:100})]},DRONE_IP_PORT:_["j"],USTATION_IP_PORT:_["n"],ip_port:[],history_data:[]}},watch:{"$route.query.id":{handler:function(e){this.action=e||0===e?Object(m["a"])({},h.update,{id:e}):h.create},immediate:!0}},created:function(){var e=this.$tools.deviceTypeNameConversion(this.deviceType);"uav"===e?this.ip_port=_["j"]:"uap"===e&&(this.ip_port=_["n"])},methods:{init:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("create"!==e.action.type){t.next=10;break}return e.form=e.$lodash.cloneDeep(d),t.next=4,Object(f["historySearch"])({device_type:e.$tools.deviceTypeNameConversion(e.deviceType)},{loading:!0});case 4:r=t.sent,200!==r.code&&(e.history_data=[]),e.history_data=r.content,t.next=18;break;case 10:if("update"!==e.action.type){t.next=18;break}return t.next=13,Object(f["search"])({id:e.action.id},{loading:!0});case 13:if(o=t.sent,200===o.code){t.next=17;break}return e.form=e.$lodash.cloneDeep(d),t.abrupt("return");case 17:e.form=o.content;case 18:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:return o={version_no:e.form.version_no,device_type:e.$tools.deviceTypeNameConversion(e.deviceType),sys_branch:e.form.sys_branch,sys_version:e.form.sys_version,sys_ip_port:e.form.sys_ip_port,lib_branch:e.form.lib_branch,lib_version:e.form.lib_version,lib_ip_port:e.form.lib_ip_port,app_branch:e.form.app_branch,app_version:e.form.app_version,app_ip_port:e.form.app_ip_port,comment:e.form.comment},"update"===e.action.type&&(o.id=e.form.id),t.next=10,e.action.submitFunc(o,{loading:!0});case 10:if(a=t.sent,200===a.code){t.next=13;break}return t.abrupt("return");case 13:e.$message({message:"".concat(e.action.title,"成功！"),type:"success",containerType:"drawer",onClose:function(){e.$router.back()}}),t.next=19;break;case 16:return t.prev=16,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},querySearch1:function(e,t){var r=this.branchFormatData(this.history_data["sys_branch"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch2:function(e,t){var r=this.versionFormatData(this.history_data["sys_version"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch3:function(e,t){var r=this.branchFormatData(this.history_data["lib_branch"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch4:function(e,t){var r=this.versionFormatData(this.history_data["lib_version"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch5:function(e,t){var r=this.branchFormatData(this.history_data["app_branch"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch6:function(e,t){var r=this.versionFormatData(this.history_data["app_version"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch7:function(e,t){var r=this.ipPortFormatData(this.history_data["sys_ip_port"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch8:function(e,t){var r=this.ipPortFormatData(this.history_data["lib_ip_port"]),o=e?r.filter(this.createFilter(e)):r;t(o)},querySearch9:function(e,t){var r=this.ipPortFormatData(this.history_data["app_ip_port"]),o=e?r.filter(this.createFilter(e)):r;t(o)},branchFormatData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.duplicateRemoval(e.concat("TX2-production")).map((function(e){return{value:e}}))},versionFormatData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.duplicateRemoval(e.concat("newest")).map((function(e){return{value:e}}))},ipPortFormatData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.duplicateRemoval(e.map((function(e){return{value:e}})))},duplicateRemoval:function(e){var t=new Set(e);return p(t)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}}}},v=b,y=r("2877"),k=Object(y["a"])(v,o,a,!1,null,null,null);t["default"]=k.exports}}]);